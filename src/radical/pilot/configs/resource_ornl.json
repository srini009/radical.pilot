
{
    "andes": {
        "description"                 : "704 compute nodes",
        "notes"                       : "Requires RSA SecurID and uses local virtual env",
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_endpoint"    : "slurm://andes.olcf.ornl.gov/",
            "filesystem_endpoint"     : "file://andes.olcf.ornl.gov/"
        },
        "forward_tunnel_endpoint"     : "andes.olcf.ornl.gov",
        "default_queue"               : "batch",
        "resource_manager"            : "SLURM",
        "agent_scheduler"             : "CONTINUOUS",
        "agent_spawner"               : "POPEN",
        "launch_methods"              : {
                                         "order": ["SRUN"],
                                         "SRUN" : {}
                                        },
        "pre_bootstrap_0"             : [
            "source /sw/andes/python/3.7/anaconda-base/etc/profile.d/conda.sh"
        ],
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "virtenv_mode"                : "local",
        "cores_per_node"              : 32
    },

    "andes_gpu": {
        "description"                 : "9 gpu nodes",
        "notes"                       : "Requires RSA SecurID and uses local virtual env",
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_endpoint"    : "slurm://andes.olcf.ornl.gov/",
            "filesystem_endpoint"     : "file://andes.olcf.ornl.gov/"
        },
        "forward_tunnel_endpoint"     : "andes.olcf.ornl.gov",
        "default_queue"               : "gpu",
        "resource_manager"            : "SLURM",
        "agent_scheduler"             : "CONTINUOUS",
        "agent_spawner"               : "POPEN",
        "launch_methods"              : {
                                         "order" : ["SRUN"],
                                         "SRUN"  : {}
                                        },
        "pre_bootstrap_0"             : [
            "source /sw/andes/python/3.7/anaconda-base/etc/profile.d/conda.sh"
        ],
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "virtenv_mode"                : "local",
        "cores_per_node"              : 28,
        "gpus_per_node"               : 2,
        "system_architecture"         : {"gpu": "k80"}
    },

    "crusher": {
        "description"                 : "2 cabinets: (1) 128 compute nodes; (2) 64 compute nodes",
        "notes"                       : "Requires RSA SecurID and uses prepared local virtual env",
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_endpoint"    : "slurm://crusher.olcf.ornl.gov/",
            "filesystem_endpoint"     : "file://crusher.olcf.ornl.gov/"
        },
        "default_queue"               : "batch",
        "resource_manager"            : "SLURM",
        "agent_config"                : "default",
        "agent_scheduler"             : "CONTINUOUS",
        "agent_spawner"               : "POPEN",
        "launch_methods"              : {
                                         "order": ["SRUN"],
                                         "SRUN" : {
                                             "pre_exec_cached": [
                                             ]
                                         }
                                        },
        "pre_bootstrap_0"             : ["module load cray-python"
                                        ],
        "pre_bootstrap_1"             : [
                                        ],
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "virtenv_mode"                : "local",
        "cores_per_node"              : 64,
        "gpus_per_node"               : 8,
        "lfs_path_per_node"           : "/tmp",
        "lfs_size_per_node"           : 0
      # "system_architecture"         : {"smt": 2,
      #                                  "options": ["nvme"]}
    },

    "spock": {
        "description"                 : "3 cabinets: each containing 12 compute nodes",
        "notes"                       : "",
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_hop"         : "fork://localhost/",
            "job_manager_endpoint"    : "slurm://localhost/",
            "filesystem_endpoint"     : "file://localhost/"
        },
        "default_queue"               : "batch",
        "resource_manager"            : "SLURM",
        "agent_config"                : "default",
        "agent_scheduler"             : "CONTINUOUS",
        "agent_spawner"               : "POPEN",
        "launch_methods"              : {
                                         "order": ["SRUN"],
                                         "SRUN" : {
                                             "pre_exec_cached": [
                                             ]
                                         }
                                        },
        "pre_bootstrap_0"             : [
                                        ],
        "pre_bootstrap_1"             : [
                                        ],
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "python_dist"                 : "default",
        "virtenv_dist"                : "default",
        "virtenv_mode"                : "local",
        "rp_version"                  : "installed",
        "gpus_per_node"               : 4,
        "cores_per_node"              : 64,
        "lfs_path_per_node"           : "/tmp",
        "lfs_size_per_node"           : 0
      # "system_architecture"         : {"smt": 2,
      #                                  "options": ["nvme"]}
    },

    "summit": {
        "description"                 : "4608 nodes with 2 IBM POWER9 CPUs and 6 NVIDIA Volta V100 GPUs",
        "notes"                       : "Requires RSA SecurID and uses local virtual env",
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_hop"         : "fork://localhost/",
            "job_manager_endpoint"    : "lsf://localhost/",
            "filesystem_endpoint"     : "file://localhost/"
        },
        "default_queue"               : "batch",
        "resource_manager"            : "LSF",
        "agent_config"                : "default",
        "agent_scheduler"             : "CONTINUOUS",
        "agent_spawner"               : "POPEN",
<<<<<<< HEAD
        "agent_launch_method"         : "JSRUN",
        "task_launch_method"          : "JSRUN",
        "mpi_launch_method"           : "JSRUN",
        "pre_bootstrap_0"             : ["module unload xl",
                                         "module unload xalt",
                                         "module unload spectrum-mpi",
=======
        "launch_methods"              : {
                                         "order": ["JSRUN"],
                                         "JSRUN": {
                                             "pre_exec_cached": [
                                               # "module unload xl",
                                               # "module unload xalt"
                                             ]
                                         }
                                        },
        "pre_bootstrap_0"             : [
>>>>>>> devel
                                         "module unload py-pip",
                                         "module unload py-virtualenv",
                                         "module unload py-setuptools",
                                         "module unload xl",
                                         "module unload xalt",
                                         "module load   gcc/9.1.0",
                                         "module load   libzmq/4.3.3",
<<<<<<< HEAD
                                         "module load   python/3.7-anaconda3",
                                         "export RADICAL_BASE=$(pwd -P)",
                                         "export RADICAL_BASE_DIR=$(pwd -P)",
                                         "module list"
                                        ],
        "pre_bootstrap_1"             : [
                                         "module unload xl",
                                         "module unload xalt",
                                         "module unload spectrum-mpi",
                                         "module load   gcc/9.1.0",
=======
                                         "module load   python/3.7-anaconda3"
                                        ],
        "pre_bootstrap_1"             : ["module load   gcc/9.1.0",
>>>>>>> devel
                                         "module load   libzmq/4.3.3",
                                         "module load   python/3.7-anaconda3",
                                         "ulimit -u 65536"
                                        ],
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "python_dist"                 : "default",
        "virtenv_dist"                : "default",
        "virtenv_mode"                : "create",
        "rp_version"                  : "local",
        "cores_per_node"              : 42,
        "gpus_per_node"               : 6,
        "blocked_cores"               : [],
        "blocked_gpus"                : [],
        "lfs_path_per_node"           : "/tmp",
        "lfs_size_per_node"           : 0,
        "system_architecture"         : {"smt": 4,
                                         "options": ["gpumps", "nvme"]}
    },

    "summit_prte": {
        "description"                 : "4608 nodes with 2 IBM POWER9 CPUs and 6 NVIDIA Volta V100 GPUs",
        "notes"                       : "Requires RSA SecurID and uses local virtual env",
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_hop"         : "fork://localhost/",
            "job_manager_endpoint"    : "lsf://localhost/",
            "filesystem_endpoint"     : "file://localhost/"
        },
        "default_queue"               : "batch",
        "resource_manager"            : "LSF",
        "agent_config"                : "default",
        "agent_scheduler"             : "CONTINUOUS",
        "agent_spawner"               : "POPEN",
        "launch_methods"              : {
                                         "order": ["PRTE", "SSH"],
                                         # for sub-agent
                                         "SSH"  : {},
                                         "PRTE" : {
                                             "pre_exec_cached": [
                                                 "module unload xl xalt spectrum-mpi",
                                                 "module load   gcc/9.1.0",
                                                 "module load   python/3.7-anaconda3",
                                                 "module use    /sw/summit/ums/ompix/gcc/9.1.0/modules",
                                               # "module use    /sw/summit/ums/ompix/DEVELOP/gcc/9.1.0/modules",
                                               # "module load   prrte/master"
                                                 "module load   prrte/2.0.0"
                                             ],
                                             "dvm_count": 1
                                         }
                                        },
        "pre_bootstrap_0"             : [
            "module unload xl xalt spectrum-mpi",
            "module load   gcc/9.1.0",
            "module load   python/3.7-anaconda3",
            "module use    /sw/summit/ums/ompix/gcc/9.1.0/modules",
            "module load   prrte/2.0.0"
        ],
        "pre_bootstrap_1"             : [
            "module unload xl xalt spectrum-mpi",
            "module load   gcc/9.1.0",
            "module load   python/3.7-anaconda3",
            "module use    /sw/summit/ums/ompix/gcc/9.1.0/modules",
            "module load   prrte/2.0.0",
            "ulimit -u 65536"
        ],
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "virtenv_mode"                : "local",
        "cores_per_node"              : 42,
        "gpus_per_node"               : 6,
        "lfs_path_per_node"           : "/tmp",
        "lfs_size_per_node"           : 0,
        "system_architecture"         : {"smt": 4,
<<<<<<< HEAD
                                         "options": ["gpumps", "nvme"]},
        "dvm_count"                   : 1
    },

    "summit_flux": {
        "description"                 : "ORNL's summit, a Cray XK7",
        "notes"                       : null,
        "schemas"                     : ["local"],
        "local"                       : {
            "job_manager_hop"         : "fork://localhost/",
            "job_manager_endpoint"    : "lsf://localhost/",
            "filesystem_endpoint"     : "file://localhost/"
        },
        "valid_roots"                 : ["$MEMBERWORK/"],
        "default_remote_workdir"      : "$MEMBERWORK/%(pd.project)s",
        "default_queue"               : "batch",
        "resource_manager"            : "LSF_SUMMIT",
        "lfs_per_node"                : "/tmp",
        "agent_config"                : "default",
        "agent_scheduler"             : "FLUX",
        "agent_spawner"               : "FLUX",
        "agent_launch_method"         : "FLUX",
        "func_launch_method"          : "FUNC",
        "task_launch_method"          : "FLUX",
        "mpi_launch_method"           : "FLUX",
        "rp_version"                  : "installed",
        "virtenv_mode"                : "use",
        "virtenv"                     : "/gpfs/alpine/med110/scratch/merzky1/radical.pilot.sandbox/ve.flux",
        "python_dist"                 : "default",
        "pre_bootstrap_0"             : [
                                         "module unload xl",
                                         "module unload xalt",
                                         "module unload spectrum-mpi",
                                         "module unload py-pip",
                                         "module unload py-virtualenv",
                                         "module unload py-setuptools",
                                         "module load   gcc/8.1.1",
                                         "module load   zeromq/4.2.5",
                                         "module load   python/3.7.0",
                                         "module use    /sw/summit/modulefiles/ums/gen007flux/Core",
                                         "module load   pmi-shim",
                                         "module load   flux"
                                        ],
        "pre_bootstrap_1"             : [
                                         "module unload xl",
                                         "module unload xalt",
                                         "module unload spectrum-mpi",
                                         "module unload py-pip",
                                         "module unload py-virtualenv",
                                         "module unload py-setuptools",
                                         "module load   gcc/8.1.1",
                                         "module load   zeromq/4.2.5",
                                         "module load   python/3.7.0",
                                         "module use    /sw/summit/modulefiles/ums/gen007flux/Core",
                                         "module load   pmi-shim",
                                         "module load   flux"
                                        ],
        "gpus_per_node"               : 1,
        "sockets_per_node"            : 2,
        "system_architecture"         : {"smt": 4,
                                         "options": ["gpumps"]}
                                         "options": ["gpumps"]}
=======
                                         "options": ["gpumps", "nvme"]}
>>>>>>> devel
    }
}

